# dz5
### Домашнее задание
### Настройка autovacuum с учетом особеностей производительности

#### Цель:
#### запустить нагрузочный тест pgbench
#### настроить параметры autovacuum
#### проверить работу autovacuum

Описание/Пошаговая инструкция выполнения домашнего задания:
1. Создать инстанс ВМ с 2 ядрами и 4 Гб ОЗУ и SSD 10GB
Установить на него PostgreSQL 15 с дефолтными настройками
````
sergt@ubuntu1:~$ pg_lsclusters
Ver Cluster Port Status Owner    Data directory              Log file
15  main    5432 online postgres /var/lib/postgresql/15/main /var/log/postgresql/postgresql-15-main.log
````
2.  Создать БД для тестов: выполнить pgbench -i postgres
```agsl
sudo apt install postgresql-contrib


postgres=# create database test5;
CREATE DATABASE
```
3. Запустить pgbench -c8 -P 6 -T 60 -U postgres postgres
4. Применить параметры настройки PostgreSQL из прикрепленного к материалам занятия файла
5. Протестировать заново Что изменилось и почему?
6. Создать таблицу с текстовым полем и заполнить случайными или сгенерированными данным в размере 1млн строк

    - Посмотреть размер файла с таблицей 
    - 5 раз обновить все строчки и добавить к каждой строчке любой символ
    - Посмотреть количество мертвых строчек в таблице и когда последний раз приходил автовакуум
    - Подождать некоторое время, проверяя, пришел ли автовакуум
    - 5 раз обновить все строчки и добавить к каждой строчке любой символ
      Посмотреть размер файла с таблицей
7. Отключить Автовакуум на конкретной таблице
     - 10 раз обновить все строчки и добавить к каждой строчке любой символ
     - Посмотреть размер файла с таблицей
     - Объясните полученный результат
     - Не забудьте включить автовакуум)
8.      Задание со *:
      Написать анонимную процедуру, в которой в цикле 10 раз обновятся все строчки в искомой таблице.
      Не забыть вывести номер шага цикла.